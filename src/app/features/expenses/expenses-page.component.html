@if (!isLoading && !loadError) {
  <section class="expenses-page">
    <header class="expenses-header">
      <button mat-icon-button type="button" (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
      </button>

      <div class="expenses-header__info">
        <h1>{{ 'expenses.title' | translate }}</h1>
        <p>
          {{ 'expenses.subtitle' | translate }}:
          <strong>{{ formatAmount(totals().balance) }}</strong>
        </p>
      </div>

      <button mat-flat-button color="primary" type="button" (click)="openCreateDialog()">
        <mat-icon>add</mat-icon>
        {{ 'expenses.add' | translate }}
      </button>
    </header>

    <section class="expenses-balance card">
      <div class="expenses-balance__title">
        <p>{{ 'expenses.balanceTitle' | translate }}</p>
        <span>{{ 'expenses.balanceHint' | translate }}</span>
      </div>
      <div class="expenses-balance__value">
        <strong>{{ formatAmount(totals().balance) }}</strong>
        <span>{{ 'expenses.labels.incomes' | translate }}: {{ formatAmount(totals().totalIncomes) }}</span>
        <span>{{ 'expenses.labels.expenses' | translate }}: -{{ formatAmount(totals().totalExpenses) }}</span>
      </div>
    </section>

    <section class="expenses-categories card">
      <h2>{{ 'expenses.categoriesTitle' | translate }}</h2>
      <div class="categories-grid">
        <div class="category-card" *ngFor="let category of categories">
          <div class="category-card__icon">{{ category.icon }}</div>
          <div class="category-card__name">
            {{ category.label | translate }}
          </div>
        </div>
      </div>
    </section>

    <section class="expenses-list card">
      <header class="expenses-list__header">
        <h2>{{ 'expenses.listTitle' | translate }}</h2>
      </header>

      @if (expenses().length) {
        <ul class="expenses-list__items">
          <li class="expense-item" *ngFor="let expense of expenses()">
            <div class="expense-item__icon">
              {{ categoryIcon(expense.category) }}
            </div>
            <div class="expense-item__details">
              <p class="expense-item__description">{{ expense.description }}</p>
              <p class="expense-item__meta">
                {{ categoryLabel(expense.category) | translate }} Â· {{ formatDate(expense.date) }}
              </p>
            </div>
            <div class="expense-item__amount">
              {{ formatAmount(-expense.amount, true) }}
            </div>
          </li>
        </ul>
      } @else {
        <p class="expenses-list__empty">{{ 'expenses.empty' | translate }}</p>
      }
    </section>
  </section>
} @else {
  <div class="expenses-state">
    @if (isLoading) {
      <div class="expenses-state__message">
        <mat-icon class="spinner-icon">autorenew</mat-icon>
        <p>{{ 'expenses.loading' | translate }}</p>
      </div>
    } @else {
      <div class="expenses-state__message">
        <p>{{ loadError | translate }}</p>
        <button mat-flat-button color="primary" type="button" (click)="reload()">
          {{ 'expenses.tryAgain' | translate }}
        </button>
      </div>
    }
  </div>
}
